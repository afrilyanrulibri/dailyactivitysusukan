<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Daily Activity Susukan — Kaunit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <header class="app-header">
    <img src="Brimo Samping.png" alt="BRIMO Icon" class="logo-icon">
    <h1>Daily Activity Susukan</h1>
  </header>

  <main class="form-container">
    <h2>Input Activity Today (Kaunit)</h2>

    <label>Nama Mantri</label>
    <select id="mantri">
      <option value="">-- Pilih Mantri --</option>
      <option>156802 EKOWATI CAHYANINGROM</option>
      <option>189290 MEGA BAGUS KURNIAWAN ABADI</option>
      <option>189417 DEDDY NOVIYANTO B.S</option>
      <option>213122 RISKA AGUSTIANA</option>
      <option>270609 SULISTIYO RINI</option>
      <option>288133 GALIH RIO PAMBUDI</option>
    </select>

    <label>NIK Nasabah</label>
    <input type="text" id="nik" placeholder="Masukkan NIK Nasabah">

    <label>Nama Nasabah</label>
    <input type="text" id="nasabah" placeholder="Masukkan Nama Nasabah">

    <label>Nomor Brimen Berkas</label>
    <input type="text" id="nomorBrimen" placeholder="Masukkan Nomor Brimen">

    <button id="submitBtn" class="btn">Simpan</button>

    <button id="goMonitoring" class="btn btn-alt">Lihat Monitoring</button>

    <div id="toast"></div>
  </main>

  <script>
    if (sessionStorage.getItem("role") !== "kaunit") {
      window.location.href = "index.html";
    }

    document.getElementById("submitBtn").onclick = async () => {
      const mantri = document.getElementById("mantri").value.trim();
      const nik = document.getElementById("nik").value.trim();
      const nas = document.getElementById("nasabah").value.trim();
      const brim = document.getElementById("nomorBrimen").value.trim();

      if (!mantri || !nik || !nas || !brim) {
        showToast("⚠ Semua field wajib diisi!");
        return;
      }

      showToast("📤 Mengirim...");

      const res = await fetch("https://script.google.com/macros/s/AKfycbzGa3NPrKyOy_gZLDgMAN3F9XfsMlg4styre1KfzqYAR9gLVpJgc8gxVQtimE6p9r9O/exec", {
        method: "POST",
        body: new URLSearchParams({
          action: "save_kaunit",
          mantri, nik, nasabah: nas, nomorBrimen: brim
        })
      });

      const j = await res.json();
      if (j.status === "sukses") {
        showToast("✅ Data tersimpan!");
        document.getElementById("nik").value = "";
        document.getElementById("nasabah").value = "";
        document.getElementById("nomorBrimen").value = "";
      } else {
        showToast("❌ Gagal simpan: " + (j.error || "unknown"));
      }
    };

    document.getElementById("goMonitoring").onclick = () => {
      window.location.href = "monitoring.html";
    };

    function showToast(msg) {
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.className = "show";
      setTimeout(() => t.className = "", 3000);
    }
  </script>
</body>
</html>
